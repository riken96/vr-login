<!DOCTYPE html>
<html>
  <head>
    <title>Google Login for VR</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 60px;
      }
      #tokenBox {
        font-family: monospace;
        color: crimson;
      }
    </style>
    <script>
      const BACKEND_URL = "https://vr-login-backend.onrender.com/createToken"; // ✅ Your backend

      function handleCredentialResponse(response) {
        const idToken = response.credential;

        // Call backend to exchange for Firebase custom token
        fetch(BACKEND_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ idToken })
        })
        .then(res => res.json())
        .then(data => {
          if (data.token) {
            localStorage.setItem("firebaseToken", data.token);
            document.getElementById("tokenBox").innerText = data.token;
            document.getElementById("tokenBox").style.color = "green";
          } else {
            throw new Error("Token creation failed.");
          }
        })
        .catch(err => {
          console.error("❌ Token error:", err);
          document.getElementById("tokenBox").innerText = "❌ Token creation failed.";
          document.getElementById("tokenBox").style.color = "crimson";
        });
      }

      window.onload = () => {
        google.accounts.id.initialize({
          client_id: "796595785111-n4m8gsegsvnjmd8ijq1r5jjtlskjkk9h.apps.googleusercontent.com",
          callback: handleCredentialResponse
        });

        google.accounts.id.renderButton(
          document.getElementById("googleButton"),
          { theme: "outline", size: "large" }
        );
      };
    </script>
  </head>
  <body>
    <h2>Sign In With Google</h2>
    <div id="googleButton"></div>
    <h3>Firebase Token:</h3>
    <pre id="tokenBox">Waiting for login...</pre>
  </body>
</html>
